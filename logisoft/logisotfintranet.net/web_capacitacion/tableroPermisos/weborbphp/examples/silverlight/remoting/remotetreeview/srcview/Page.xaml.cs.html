<!--
This file was generated by Web C Plus Plus software v0.7.13
Webcpp Copyright (C)2001, (C)2002, (C)2003 Jeffrey Bakker under the GNU GPL
Get webcpp at http://webcpp.sf.net
-->

<html>
<head>
<title>Page.xaml.cs</title>
<style type="text/css">

/** Webcpp v0.7.0+ compatible StyleSheet http://webcpp.sf.net **/
/** Theme: ide-msvcpp **/

body
{
background-color: #ffffff
}

a:link    {color:#000000}
a:visited {color:#008000}
a:active  {color:#0000ff}
a:hover   {color:#0000ff}

pre
{
color: #000000
}

font
{
font-size:100%
}

font.preproc
{
color: #0000ff
}

font.numbers
{
color: #000000
}

font.strings
{
color: #000000
}

font.keyword
{
color: #0000ff;
font-weight: bold
}

font.comment
{
color: #008000;
font-style: italic
}

</style>
</head>
<body>
<pre>

     <font CLASS=comment>1:</font> ï»¿using System;
     <font CLASS=comment>2:</font> <font CLASS=keyword>using</font> System.Collections.Generic;
     <font CLASS=comment>3:</font> <font CLASS=keyword>using</font> System.Collections.ObjectModel;
     <font CLASS=comment>4:</font> <font CLASS=keyword>using</font> System.Linq;
     <font CLASS=comment>5:</font> <font CLASS=keyword>using</font> System.Net;
     <font CLASS=comment>6:</font> <font CLASS=keyword>using</font> System.Windows;
     <font CLASS=comment>7:</font> <font CLASS=keyword>using</font> System.Windows.Controls;
     <font CLASS=comment>8:</font> <font CLASS=keyword>using</font> System.Windows.Documents;
     <font CLASS=comment>9:</font> <font CLASS=keyword>using</font> System.Windows.Input;
    <font CLASS=comment>10:</font> <font CLASS=keyword>using</font> System.Windows.Media;
    <font CLASS=comment>11:</font> <font CLASS=keyword>using</font> System.Windows.Media.Animation;
    <font CLASS=comment>12:</font> <font CLASS=keyword>using</font> System.Windows.Shapes;
    <font CLASS=comment>13:</font> <font CLASS=keyword>using</font> TreeView;
    <font CLASS=comment>14:</font> <font CLASS=keyword>using</font> Weborb.Client;
    <font CLASS=comment>15:</font> <font CLASS=keyword>using</font> Weborb.Types;
    <font CLASS=comment>16:</font> <font CLASS=keyword>namespace</font> SilverlightTreeView
    <font CLASS=comment>17:</font> {
    <font CLASS=comment>18:</font>     <font CLASS=keyword>public</font> partial <font CLASS=keyword>class</font> Page : UserControl
    <font CLASS=comment>19:</font>     {
    <font CLASS=comment>20:</font>         <font CLASS=keyword>private</font> WeborbClient proxy;
    <font CLASS=comment>21:</font> 
    <font CLASS=comment>22:</font>         <font CLASS=keyword>public</font> Page()
    <font CLASS=comment>23:</font>         {
    <font CLASS=comment>24:</font>             InitializeComponent();
    <font CLASS=comment>25:</font> 
    <font CLASS=comment>26:</font>             Types.AddClientClassMapping( <font CLASS=strings>"Weborb.Examples.FileSystemItem"</font>, <font CLASS=keyword>typeof</font>( FileSystemItem ) );
    <font CLASS=comment>27:</font>             Types.AddClientClassMapping( <font CLASS=strings>"Weborb.Examples.FolderItem"</font>, <font CLASS=keyword>typeof</font>( FolderItem ) );
    <font CLASS=comment>28:</font> 
    <font CLASS=comment>29:</font>             <font CLASS=comment>// keep the URL relative - just weborb.aspx for .NET or weborb.php for PHP</font>
    <font CLASS=comment>30:</font>             <font CLASS=comment>// The API accepts absolute URLs as well</font>
    <font CLASS=comment>31:</font>             proxy = <font CLASS=keyword>new</font> WeborbClient( App.WeborbURL, <font CLASS=keyword>this</font> );
    <font CLASS=comment>32:</font>             <font CLASS=keyword>this</font>.Loaded += <font CLASS=keyword>new</font> RoutedEventHandler( Page_Loaded );
    <font CLASS=comment>33:</font>         }
    <font CLASS=comment>34:</font> 
    <font CLASS=comment>35:</font>         <font CLASS=keyword>void</font> Page_Loaded( <font CLASS=keyword>object</font> sender, RoutedEventArgs e )
    <font CLASS=comment>36:</font>         {
    <font CLASS=comment>37:</font>             Responder&lt;List&lt;FileSystemItem&gt;&gt; responder = <font CLASS=keyword>new</font> Responder&lt;List&lt;FileSystemItem&gt;&gt;( gotDirectory, <font CLASS=keyword>null</font> );
    <font CLASS=comment>38:</font>             proxy.Invoke( <font CLASS=strings>"Weborb.Examples.FileSystemBrowser"</font>, <font CLASS=strings>"getRoot"</font>, <font CLASS=keyword>null</font>, responder );
    <font CLASS=comment>39:</font>         }
    <font CLASS=comment>40:</font> 
    <font CLASS=comment>41:</font>         <font CLASS=keyword>public</font> <font CLASS=keyword>void</font> gotDirectory( List&lt;FileSystemItem&gt; rootEntries )
    <font CLASS=comment>42:</font>         {
    <font CLASS=comment>43:</font>             ObservableCollection&lt;TreeViewNode&gt; nodes = <font CLASS=keyword>null</font>;
    <font CLASS=comment>44:</font> 
    <font CLASS=comment>45:</font>             <font CLASS=keyword>if</font>( fileSystemTree.Selected != <font CLASS=keyword>null</font> )
    <font CLASS=comment>46:</font>                 nodes = fileSystemTree.Selected.TreeViewNodes;
    <font CLASS=comment>47:</font>             <font CLASS=keyword>else</font>
    <font CLASS=comment>48:</font>                 nodes = fileSystemTree.TreeViewNodes;
    <font CLASS=comment>49:</font> 
    <font CLASS=comment>50:</font>             <font CLASS=keyword>foreach</font>( FileSystemItem fileItem <font CLASS=keyword>in</font> rootEntries )
    <font CLASS=comment>51:</font>             {
    <font CLASS=comment>52:</font>                 TreeViewNode node = <font CLASS=keyword>new</font> TreeViewNode( 
    <font CLASS=comment>53:</font>                     fileItem.fullName, 
    <font CLASS=comment>54:</font>                     fileItem.Name, 
    <font CLASS=comment>55:</font>                     fileItem <font CLASS=keyword>is</font> FolderItem, 
    <font CLASS=comment>56:</font>                     fileItem <font CLASS=keyword>is</font> FolderItem ? 
    <font CLASS=comment>57:</font>                         <font CLASS=strings>"images/Folder-Closed-16x16.png"</font><font CLASS=preproc> :</font>
    <font CLASS=comment>58:</font>                         <font CLASS=strings>"images/Document-16x16.png"</font>
    <font CLASS=comment>59:</font>                     );
    <font CLASS=comment>60:</font>                 node.DataContext = fileItem;
    <font CLASS=comment>61:</font>                 nodes.Add( node );
    <font CLASS=comment>62:</font>             }
    <font CLASS=comment>63:</font> 
    <font CLASS=comment>64:</font>             <font CLASS=keyword>if</font>( fileSystemTree.Selected != <font CLASS=keyword>null</font> )
    <font CLASS=comment>65:</font>                 fileSystemTree.Selected.Expand();
    <font CLASS=comment>66:</font>         }
    <font CLASS=comment>67:</font>         
    <font CLASS=comment>68:</font>         <font CLASS=keyword>private</font> <font CLASS=keyword>void</font> fileSystemTree_SelectionChanged( <font CLASS=keyword>object</font> sender, EventArgs e )
    <font CLASS=comment>69:</font>         {
    <font CLASS=comment>70:</font>             FormRoot.DataContext = ((TreeView.TreeView) sender).Selected.DataContext;
    <font CLASS=comment>71:</font>         }
    <font CLASS=comment>72:</font>         
    <font CLASS=comment>73:</font>         <font CLASS=keyword>private</font> <font CLASS=keyword>void</font> fileSystemTree_TreeViewNodeClick( <font CLASS=keyword>object</font> sender, TreeViewEventArgs e )
    <font CLASS=comment>74:</font>         {
    <font CLASS=comment>75:</font>             fetchDirectoryInfo( e.Source );
    <font CLASS=comment>76:</font>         }
    <font CLASS=comment>77:</font> 
    <font CLASS=comment>78:</font>         <font CLASS=keyword>private</font> <font CLASS=keyword>void</font> fileSystemTree_Populate( <font CLASS=keyword>object</font> sender, TreeViewEventArgs e )
    <font CLASS=comment>79:</font>         {
    <font CLASS=comment>80:</font>             fetchDirectoryInfo( (TreeViewNode)sender );
    <font CLASS=comment>81:</font>         }
    <font CLASS=comment>82:</font> 
    <font CLASS=comment>83:</font>         <font CLASS=keyword>private</font> <font CLASS=keyword>void</font> fetchDirectoryInfo( TreeViewNode treeNode )
    <font CLASS=comment>84:</font>         {
    <font CLASS=comment>85:</font>             <font CLASS=keyword>if</font>( treeNode.HasChildren &amp;&amp; treeNode.TreeViewNodes.Count == <font CLASS=numbers>0</font> )
    <font CLASS=comment>86:</font>             {
    <font CLASS=comment>87:</font>                 fileSystemTree.Selected = treeNode;
    <font CLASS=comment>88:</font>                 Responder&lt;List&lt;FileSystemItem&gt;&gt; responder = <font CLASS=keyword>new</font> Responder&lt;List&lt;FileSystemItem&gt;&gt;( gotDirectory, <font CLASS=keyword>null</font> );
    <font CLASS=comment>89:</font>                 proxy.Invoke( <font CLASS=strings>"Weborb.Examples.FileSystemBrowser"</font>, <font CLASS=strings>"getDirectory"</font>, <font CLASS=keyword>new</font> <font CLASS=keyword>string</font>[] { treeNode.ID }, responder );
    <font CLASS=comment>90:</font>             }
    <font CLASS=comment>91:</font>         }
    <font CLASS=comment>92:</font>     }
    <font CLASS=comment>93:</font> 
    <font CLASS=comment>94:</font>     <font CLASS=keyword>public</font> <font CLASS=keyword>class</font> FileSystemItem
    <font CLASS=comment>95:</font>     {
    <font CLASS=comment>96:</font>         <font CLASS=keyword>public</font> String Name {<font CLASS=keyword>get</font>;<font CLASS=keyword>set</font>;}
    <font CLASS=comment>97:</font>         <font CLASS=keyword>public</font> String fullName {<font CLASS=keyword>get</font>;<font CLASS=keyword>set</font>;}
    <font CLASS=comment>98:</font>         <font CLASS=keyword>public</font> DateTime createdOn { <font CLASS=keyword>get</font>; <font CLASS=keyword>set</font>; }
    <font CLASS=comment>99:</font>         <font CLASS=keyword>public</font> DateTime lastAccessedOn { <font CLASS=keyword>get</font>; <font CLASS=keyword>set</font>; }
   <font CLASS=comment>100:</font>         <font CLASS=keyword>public</font> DateTime lastWrittenOn { <font CLASS=keyword>get</font>; <font CLASS=keyword>set</font>; }
   <font CLASS=comment>101:</font>         <font CLASS=keyword>public</font> <font CLASS=keyword>long</font> size { <font CLASS=keyword>get</font>; <font CLASS=keyword>set</font>; }
   <font CLASS=comment>102:</font>     }
   <font CLASS=comment>103:</font> 
   <font CLASS=comment>104:</font>     <font CLASS=keyword>public</font> <font CLASS=keyword>class</font> FolderItem : FileSystemItem
   <font CLASS=comment>105:</font>     {
   <font CLASS=comment>106:</font>         <font CLASS=keyword>public</font> List&lt;FileSystemItem&gt; Items { <font CLASS=keyword>get</font>; <font CLASS=keyword>set</font>; }
   <font CLASS=comment>107:</font>     }
   <font CLASS=comment>108:</font> }
   <font CLASS=comment>109:</font> 


</pre>



</body>
</html>
