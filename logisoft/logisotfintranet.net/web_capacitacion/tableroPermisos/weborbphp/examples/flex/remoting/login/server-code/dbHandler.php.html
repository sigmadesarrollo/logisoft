<html>
<head>
<title>Codex Source (PHP): dbHandler.php.html</title>
</head>
<!-- Generated by SynEdit HTML exporter -->
<body text="#000000" bgcolor="#FFFFFF">
<pre>
<code><font  size="3" face="Courier New"><span style="background-color: #FFFFFF"><font color="#000000">&lt;?php
</font><font color="#0000FF"><b>class</b> </font><font color="#000000">dbHandler {
	private </font><font color="#008000">$link</font><font color="#000000">;
		
	public  </font><font color="#0000FF"><b>function</b> </font><font color="#000000">__construct(){
		</font><font color="#0000FF"><b>if</b></font><font color="#000000">(!defined(</font><font color="#FF0000">&quot;WebOrbServicesPath&quot;</font><font color="#000000">))
		{
			</font><font color="#008000">$dom </font><font color="#000000">= </font><font color="#0000FF"><b>new</b> </font><font color="#000000">DomDocument();
	        </font><font color="#008000">$dom</font><font color="#000000">-&gt;load(WebOrb . </font><font color="#FF0000">&quot;weborb-config.xml&quot;</font><font color="#000000">);
	
	        </font><font color="#008000">$servicePath </font><font color="#000000">= </font><font color="#008000">$dom</font><font color="#000000">-&gt;documentElement-&gt;getAttribute(</font><font color="#FF0000">'servicePath'</font><font color="#000000">);
	        define(</font><font color="#FF0000">&quot;WebOrbServicesPath&quot;</font><font color="#000000">, realpath(WebOrb . </font><font color="#008000">$servicePath </font><font color="#000000">) . DIRECTORY_SEPARATOR);
		}
		</font><font color="#0000FF"><b>if</b></font><font color="#000000">(file_exists(WebOrbServicesPath . </font><font color="#FF0000">&quot;Weborb/Examples/Security/datbase.db&quot;</font><font color="#000000">))
		{
			</font><font color="#0000FF"><b>if</b></font><font color="#000000">(!</font><font color="#008000">$this</font><font color="#000000">-&gt;link = sqlite_open(WebOrbServicesPath . </font><font color="#FF0000">&quot;Weborb/Examples/Security/datbase.db&quot;</font><font color="#000000">, </font><font color="#FF00FF">0666</font><font color="#000000">, </font><font color="#008000">$sqliteerror</font><font color="#000000">))
				throw </font><font color="#0000FF"><b>new</b> </font><font color="#000000">Exception(</font><font color="#008000">$sqliteerror</font><font color="#000000">);	
		}
		</font><font color="#0000FF"><b>else
</b></font><font color="#000000">		{
			</font><font color="#0000FF"><b>if</b></font><font color="#000000">(!</font><font color="#008000">$this</font><font color="#000000">-&gt;link = sqlite_open(WebOrbServicesPath . </font><font color="#FF0000">&quot;Weborb/Examples/Security/datbase.db&quot;</font><font color="#000000">, </font><font color="#FF00FF">0666</font><font color="#000000">, </font><font color="#008000">$sqliteerror</font><font color="#000000">))
				throw </font><font color="#0000FF"><b>new</b> </font><font color="#000000">Exception(</font><font color="#008000">$sqliteerror</font><font color="#000000">);	
			sqlite_query(</font><font color="#008000">$this</font><font color="#000000">-&gt;link,</font><font color="#FF0000">&quot;CREATE TABLE Security ( Id INT, UserName VARCHAR(20), Password VARCHAR(20), Role VARCHAR(20) )&quot;</font><font color="#000000">);
			sqlite_query(</font><font color="#008000">$this</font><font color="#000000">-&gt;link,</font><font color="#FF0000">&quot;INSERT INTO Security (Id, UserName, Password, Role) VALUES ( 1, 'joe', 'flexrocks', 'examplesuser' )&quot;</font><font color="#000000">);
			sqlite_query(</font><font color="#008000">$this</font><font color="#000000">-&gt;link,</font><font color="#FF0000">&quot;INSERT INTO Security (Id, UserName, Password, Role) VALUES ( 2, 'bob', 'weborb', 'administrator' )&quot;</font><font color="#000000">);
			sqlite_query(</font><font color="#008000">$this</font><font color="#000000">-&gt;link,</font><font color="#FF0000">&quot;CREATE TABLE Products ( Id INT, Name VARCHAR(20), Price NUMERIC )&quot;</font><font color="#000000">);
			sqlite_query(</font><font color="#008000">$this</font><font color="#000000">-&gt;link,</font><font color="#FF0000">&quot;INSERT INTO Products (Id, Name, Price) VALUES ( 1, 'Laptop', 499 )&quot;</font><font color="#000000">);
			sqlite_query(</font><font color="#008000">$this</font><font color="#000000">-&gt;link,</font><font color="#FF0000">&quot;INSERT INTO Products (Id, Name, Price) VALUES ( 2, 'Mouse', 20 )&quot;</font><font color="#000000">);
			sqlite_query(</font><font color="#008000">$this</font><font color="#000000">-&gt;link,</font><font color="#FF0000">&quot;INSERT INTO Products (Id, Name, Price) VALUES ( 3, 'Keyboard', 10 )&quot;</font><font color="#000000">);
		}
	}
	
	public </font><font color="#0000FF"><b>function</b> </font><font color="#000000">getDbHandler()
	{
		</font><font color="#0000FF"><b>return</b> </font><font color="#008000">$this</font><font color="#000000">-&gt;link;
	}
	public </font><font color="#0000FF"><b>function</b> </font><font color="#000000">close()
	{
		sqlite_close(</font><font color="#008000">$this</font><font color="#000000">-&gt;link);
	}
}

?&gt;
</font></span></font>
</code></pre>
</body>
</html>