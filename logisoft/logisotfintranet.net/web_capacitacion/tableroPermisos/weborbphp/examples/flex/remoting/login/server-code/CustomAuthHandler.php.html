<html>
<head>
<title>Codex Source (PHP): CustomAuthHandler.php.html</title>
</head>
<!-- Generated by SynEdit HTML exporter -->
<body text="#000000" bgcolor="#FFFFFF">
<pre>
<code><font  size="3" face="Courier New"><span style="background-color: #FFFFFF"><font color="#000000">&lt;?php
</font><font color="#0000FF"><i>/*******************************************************************
 * CustomAuthHandler.php
 * Copyright (C) 2006-2007 Midnight Coders, LLC
 *
 * The contents of this file are subject to the Mozilla Public License
 * Version 1.1 (the &quot;License&quot;); you may not use this file except in
 * compliance with the License. You may obtain a copy of the License at
 * http://www.mozilla.org/MPL/
 *
 * Software distributed under the License is distributed on an &quot;AS IS&quot;
 * basis, WITHOUT WARRANTY OF ANY KIND, either express or implied. See the
 * License for the specific language governing rights and limitations
 * under the License.
 *
 * The Original Code is WebORB Presentation Server (R) for PHP.
 * 
 * The Initial Developer of the Original Code is Midnight Coders, LLC.
 * All Rights Reserved.
 ********************************************************************/

</i></font><font color="#000000">require_once(WebOrb . </font><font color="#FF0000">&quot;Security/IAuthenticationHandler.php&quot;</font><font color="#000000">);
require_once(</font><font color="#FF0000">&quot;dbHandler.php&quot;</font><font color="#000000">);
require_once(WebOrb . </font><font color="#FF0000">&quot;Util/Logging/Log.php&quot;</font><font color="#000000">);
require_once(WebOrb . </font><font color="#FF0000">&quot;Util/Logging/LoggingConstants.php&quot;</font><font color="#000000">);

</font><font color="#0000FF"><b>class</b> </font><font color="#000000">CustomAuthHandler implements IAuthenticationHandler
{
	</font><font color="#0000FF"><i>/*void*/</i> <b>function</b> </font><font color="#000000">checkCredentials( </font><font color="#0000FF"><i>/*string*/</i> </font><font color="#008000">$userid</font><font color="#000000">, </font><font color="#0000FF"><i>/*string*/</i> </font><font color="#008000">$password</font><font color="#000000">, Request </font><font color="#008000">$message </font><font color="#000000">)
	{
		</font><font color="#008000">$db </font><font color="#000000">= </font><font color="#0000FF"><b>new</b> </font><font color="#000000">dbHandler();
		</font><font color="#008000">$link </font><font color="#000000">= </font><font color="#008000">$db</font><font color="#000000">-&gt;getDbHandler();
		
    	</font><font color="#008000">$query </font><font color="#000000">= </font><font color="#FF0000">&quot;SELECT * FROM Security WHERE Username = '&quot; </font><font color="#000000">. </font><font color="#008000">$userid </font><font color="#000000">. </font><font color="#FF0000">&quot;' and Password = '&quot; </font><font color="#000000">. </font><font color="#008000">$password </font><font color="#000000">+ </font><font color="#FF0000">&quot;'&quot;</font><font color="#000000">;
	   	</font><font color="#008000">$result </font><font color="#000000">= sqlite_query(</font><font color="#008000">$query</font><font color="#000000">,</font><font color="#008000">$link</font><font color="#000000">);

	   	</font><font color="#008000">$row </font><font color="#000000">= sqlite_fetch_single(</font><font color="#008000">$result</font><font color="#000000">);
	   	
	    </font><font color="#008000">$db</font><font color="#000000">-&gt;close();	

	    </font><font color="#0000FF"><b>if</b></font><font color="#000000">(</font><font color="#008000">$row</font><font color="#000000">[</font><font color="#FF00FF">0</font><font color="#000000">] == </font><font color="#FF00FF">0</font><font color="#000000">)
			throw </font><font color="#0000FF"><b>new</b> </font><font color="#000000">WebORBAuthenticationException( </font><font color="#FF0000">&quot;invalid userid or password&quot; </font><font color="#000000">);
	}
}
?&gt;
</font></span></font>
</code></pre>
</body>
</html>